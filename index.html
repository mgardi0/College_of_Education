<!DOCTYPE html>
<html lang="ckb" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پێشبڕکێی کۆلێژی پەروەردە</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rudaw&display=swap');
        :root { --primary-color: #4a90e2; --secondary-color: #50e3c2; --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        
        body { 
            font-family: 'Rudaw', Tahoma, sans-serif; 
            background: var(--bg-gradient); 
            display: flex; justify-content: center; align-items: center; 
            min-height: 100vh; margin: 0; color: #333; 
        }
        
        .container { 
            background: white; padding: 2rem; border-radius: 20px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); width: 90%; max-width: 500px; text-align: center; 
        }
        
        .logo { width: 100px; margin-bottom: 20px; }
        .screen { display: none; animation: fadeIn 0.5s ease; }
        .screen.active { display: block; }
        
        h1 { font-size: 1.5rem; color: #2c3e50; margin-bottom: 15px; }
        h2 { color: #34495e; }
        
        input, select { 
            width: 100%; padding: 12px; margin: 10px 0; 
            border: 2px solid #ddd; border-radius: 10px; font-family: inherit; box-sizing: border-box; font-size: 1rem;
        }
        
        .btn { 
            background: var(--primary-color); color: white; border: none; 
            padding: 12px 25px; border-radius: 10px; cursor: pointer; 
            font-size: 1.1rem; margin-top: 10px; width: 100%; transition: 0.3s; 
        }
        .btn:hover { opacity: 0.9; transform: translateY(-2px); }
        
        .options { display: flex; gap: 10px; margin-top: 20px; }
        .answer-btn { flex: 1; padding: 15px; font-size: 1.2rem; }
        .answer-btn:nth-child(1) { background-color: #27ae60; } /* سەوز */
        .answer-btn:nth-child(2) { background-color: #c0392b; } /* سور */
        
        .timer-bar { 
            width: 100%; height: 8px; background: #eee; 
            margin-bottom: 20px; border-radius: 5px; overflow: hidden; 
        }
        #time-left { 
            height: 100%; background: var(--secondary-color); 
            width: 100%; transition: width 1s linear; 
        }
        
        #countdown-number { font-size: 6rem; color: var(--primary-color); font-weight: bold; }
        
        #leaderboard-list { 
            list-style: none; padding: 0; text-align: right; 
            max-height: 200px; overflow-y: auto; background: #f8f9fa; border-radius: 10px;
        }
        #leaderboard-list li { 
            padding: 10px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between;
        }
        #leaderboard-list li:nth-child(1) { background-color: #ffd700; font-weight: bold; } /* یەکەم زەرد */
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="container">
        <div class="logo-container"><img src="logo.png" alt="College Logo" class="logo"></div>

        <div id="welcome-screen" class="screen active">
            <h1>پێشبڕکێی زانستی</h1>
            <p>بەخێربێن بۆ پێشبڕکێی کۆلێژی پەروەردە</p>
            <form id="user-form">
                <input type="text" id="username" placeholder="ناوی سیانی" required>
                <select id="department" required>
                    <option value="" disabled selected>بەشەکەت هەڵبژێرە</option>
                    <option value="Biology">بایۆلۆجی</option>
                    <option value="Chemistry">کیمیا</option>
                    <option value="Physics">فیزیا</option>
                    <option value="Mathematics">ماتماتیک</option>
                    <option value="Guidance">ڕێنمایی پەروەردەیی و دەروونی</option>
                    <option value="Special Education">پەروەردەی تایبەت</option>
                    <option value="English">زمانی ئینگلیزی</option>
                    <option value="Arabic">زمانی عەرەبی</option>
                    <option value="Kurdish">زمانی کوردی</option>
                    <option value="Syriac">زمانی سریانی</option>
                </select>
                <button type="submit" class="btn">دەستپێکردن</button>
            </form>
        </div>

        <div id="countdown-screen" class="screen">
            <h2>ئامادەبە...</h2>
            <div id="countdown-number">3</div>
        </div>

        <div id="quiz-screen" class="screen">
            <div class="timer-bar"><div id="time-left"></div></div>
            <h2 id="question-text" style="min-height: 80px;">پرسیار</h2>
            <div class="options">
                <button class="btn answer-btn" onclick="checkAnswer(true)">ڕاست</button>
                <button class="btn answer-btn" onclick="checkAnswer(false)">هەڵە</button>
            </div>
            <p class="question-count">پرسیاری <span id="current-q">1</span> لە 10</p>
        </div>

        <div id="result-screen" class="screen">
            <h2>تەواو بوو!</h2>
            <div style="font-size: 2rem; margin: 20px 0;">نمرەکەت: <strong id="final-score" style="color:var(--primary-color)">0</strong> / 10</div>
            
            <p id="save-status" style="color: gray; font-style: italic;">⏳ خەریکە نمرەکەت تۆمار دەکرێت...</p>
            
            <button onclick="showLeaderboard()" class="btn secondary" style="background-color: #f39c12; margin-top: 20px;">بینینی ڕیزبەندی ٢٠ یەکەمەکان</button>
            
            <div id="leaderboard" style="display:none; margin-top: 20px;">
                <h3>ڕیزبەندی بەشداربووان</h3>
                <ul id="leaderboard-list"></ul>
                <button onclick="location.reload()" class="btn" style="background:#bdc3c7; margin-top:10px;">دەرچوون</button>
            </div>
        </div>
    </div>

    <script>
        // ------------------------------------------------
        // بەشی یەکەم: کۆدی فایەربەیس (ئەوەی ئیشی کرد)
        // ------------------------------------------------
        const firebaseConfig = {
            apiKey: "AIzaSyBhv5zKnpk4DV1w_s9y2vbrv17Fmdyw1qs",
            authDomain: "college-of-education-f5c3e.firebaseapp.com",
            projectId: "college-of-education-f5c3e",
            storageBucket: "college-of-education-f5c3e.firebasestorage.app",
            messagingSenderId: "1014558650015",
            appId: "1:1014558650015:web:82a40961bfd5f750f4bcaa",
            measurementId: "G-1WJM3VEJQH"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // ------------------------------------------------
        // بەشی دووەم: پرسیارەکان
        // ------------------------------------------------
        const questions = [
            { text: "ڤایرۆسەکان وەک زیندەوەرێکی تەواو پۆلێن دەکرێن چونکە دەتوانن بەبێ خانەی خانەخوێ (Host) گەشە بکەن.", answer: false },
            { text: "ئەڵماس و گرافیت هەردووکیان لە گەردیلەی کاربۆن پێکدێن، بۆیە گرافیت ڕەقترین ماددەیە لە سروشتدا.", answer: false },
            { text: "دەنگ لە بۆشاییدا (Space) خێراتر دەڕوات وەک لەوەی لە ناو ئاودا بڕوات.", answer: false },
            { text: "هەر ژمارەیەک (جگە لە سفر) ئەگەر توانەکەی (Exponent) ببێتە سفر، ئەوا ئەنجامەکەی یەکسانە بە یەک.", answer: true },
            { text: "بیردۆزی 'مەرجداربوونی کلاسیکی' (Classical Conditioning) کە تاقیکردنەوەی لەسەر سەگ کرد، لەلایەن زانا بی ئێف سکینەر پەرەی پێدراوە.", answer: false }, // سکینەر هی Operant بوو، پاڤلۆڤ هی کلاسیکی بوو
            { text: "ئۆتیزم (Autism) جۆرە نەخۆشییەکی دەروونی کاتییە و دەتوانرێت بە بەکارهێنانی دەرمانی پزیشکی بە تەواوی بنبڕ بکرێت.", answer: false },
            { text: "The word 'Information' is a countable noun, so we can say 'I have many informations'.", answer: false },
            { text: "کاتێک وشەی (لم) دەچێتە سەر کرداری داهاتوو (الفعل المضارع)، نیشانەی کۆتاییەکەی دەگۆڕێت بۆ (الفتحة).", answer: false }, // دەبێتە سکون
            { text: "شاعیری ناودار 'هێمن موکریانی' نووسەری شاکارە شیعری 'مەم و زین'ـە.", answer: false }, // خانی نوسیویەتی
            { text: "پیتی (ܐ - ئالەف) لە زمانی سریانیدا، تەنها لە کۆتایی وشەدا دەنووسرێت و لە سەرەتای وشەدا نایەت.", answer: false }
        ];

        let currentQuestionIndex = 0, score = 0, timer, timeLeft = 8, userInfo = {};

        // ناساندنی توخمەکان
        const welcomeScreen = document.getElementById('welcome-screen');
        const countdownScreen = document.getElementById('countdown-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultScreen = document.getElementById('result-screen');
        const questionText = document.getElementById('question-text');
        const currentQSpan = document.getElementById('current-q');
        const timeLeftBar = document.getElementById('time-left');

        // دەستپێکردن
        document.getElementById('user-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('username').value;
            if(!name) return;
            
            userInfo.name = name;
            userInfo.department = document.getElementById('department').value;
            welcomeScreen.classList.remove('active');
            startCountdown();
        });

        function startCountdown() {
            countdownScreen.classList.add('active');
            let count = 3;
            const countDisplay = document.getElementById('countdown-number');
            const countInterval = setInterval(() => {
                count--;
                countDisplay.innerText = count;
                if (count <= 0) {
                    clearInterval(countInterval);
                    countdownScreen.classList.remove('active');
                    startQuiz();
                }
            }, 1000);
        }

        function startQuiz() {
            quizScreen.classList.add('active');
            loadQuestion();
        }

        function loadQuestion() {
            if (currentQuestionIndex >= questions.length) { endQuiz(); return; }
            const q = questions[currentQuestionIndex];
            questionText.innerText = q.text;
            currentQSpan.innerText = currentQuestionIndex + 1;
            resetTimer();
        }

        function resetTimer() {
            timeLeft = 8;
            updateTimerUI();
            clearInterval(timer);
            timer = setInterval(() => {
                timeLeft--;
                updateTimerUI();
                if (timeLeft <= 0) { clearInterval(timer); currentQuestionIndex++; loadQuestion(); }
            }, 1000);
        }

        function updateTimerUI() { timeLeftBar.style.width = (timeLeft / 8) * 100 + "%"; }
        
        function checkAnswer(userChoice) { 
            clearInterval(timer); 
            if (userChoice === questions[currentQuestionIndex].answer) score++; 
            currentQuestionIndex++; 
            loadQuestion(); 
        }

        function endQuiz() {
            quizScreen.classList.remove('active');
            resultScreen.classList.add('active');
            document.getElementById('final-score').innerText = score;
            
            // ناردنی داتا بۆ فایەربەیس
            const statusText = document.getElementById('save-status');
            
            db.collection("results").add({
                name: userInfo.name,
                department: userInfo.department,
                score: score,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            }).then(() => {
                statusText.innerHTML = "✅ <span style='color:green'>نمرەکەت بە سەرکەوتوویی تۆمار کرا.</span>";
            }).catch((error) => {
                statusText.innerText = "❌ هەڵە لە تۆمارکردن: " + error.message;
                statusText.style.color = "red";
            });
        }

        function showLeaderboard() {
            const list = document.getElementById('leaderboard-list');
            document.getElementById('leaderboard').style.display = 'block';
            list.innerHTML = '<li>جار دەکرێت...</li>';
            
            db.collection("results").orderBy("score", "desc").limit(20).get()
            .then((querySnapshot) => {
                list.innerHTML = '';
                if(querySnapshot.empty) {
                    list.innerHTML = '<li>هیچ داتایەک نییە</li>';
                }
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    list.innerHTML += `<li><span>${data.name}</span> <span>${data.score}</span></li>`;
                });
            })
            .catch((error) => {
                list.innerHTML = '<li>هەڵە لە هێنان</li>';
            });
        }
    </script>
</body>
</html>
